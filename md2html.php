<?php
/*
 * Short Downgen version - MD2HTML
 *
 * MD2HTML Copyright (c) 2014 Jiri Hybek, jiri@hybek.cz 
 * Parsedown Copyright (c) 2013 Emanuil Rusev, erusev.com
 * Github-markdown-css Copyright (c) Sindre Sorhus, sindresorhus.com
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy of this software
 * and associated documentation files (the "Software"), to deal in the Software without restriction,
 * including without limitation the rights to use, copy, modify, merge, publish, distribute,
 * sublicense, and/or sell copies of the Software, and to permit persons to whom the Software
 * is furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all copies or substantial
 * portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT
 * LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.
 * IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
 * WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH
 * THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 */

global $srcDir, $dstDir, $title, $description, $index, $mdIndex;

//Read args
$srcDir 		= ( isset($argv[1]) ? $argv[1] : ( isset($GET["dir"]) ? $_GET["dir"] : dirname(__FILE__) ) );
$dstDir 		= ( isset($argv[2]) ? $argv[2] : ( isset($GET["out"]) ? $_GET["out"] : dirname(__FILE__) . "/html" ) );
$title  		= ( isset($argv[3]) ? $argv[3] : ( isset($GET["title"]) ? $_GET["title"] : "Downgen" ) );
$description  	= ( isset($argv[4]) ? $argv[4] : ( isset($GET["description"]) ? $_GET["description"] : "Documentation" ) );
$index  		= ( isset($argv[5]) ? $argv[5] : ( isset($GET["index"]) ? $_GET["index"] : "README" ) );

//Parsedown classes
class Parsedown{function text($text){$this->Definitions=array();$text=str_replace("\r\n","\n",$text);$text=str_replace("\r","\n",$text);$text=str_replace("\t",'    ',$text);$text=trim($text,"\n");$lines=explode("\n",$text);$markup=$this->lines($lines);$markup=trim($markup,"\n");return $markup;} private $breaksEnabled;function setBreaksEnabled($breaksEnabled){$this->breaksEnabled=$breaksEnabled;return $this;} protected $BlockTypes=array('#'=>array('Atx'),'*'=>array('Rule','List'),'+'=>array('List'),'-'=>array('Setext','Table','Rule','List'),'0'=>array('List'),'1'=>array('List'),'2'=>array('List'),'3'=>array('List'),'4'=>array('List'),'5'=>array('List'),'6'=>array('List'),'7'=>array('List'),'8'=>array('List'),'9'=>array('List'),':'=>array('Table'),'<'=>array('Comment','Markup'),'='=>array('Setext'),'>'=>array('Quote'),'_'=>array('Rule'),'`'=>array('FencedCode'),'|'=>array('Table'),'~'=>array('FencedCode'),); protected $DefinitionTypes=array('['=>array('Reference'),); protected $unmarkedBlockTypes=array('CodeBlock',); private function lines(array$lines){$CurrentBlock=null;foreach($lines as $line){if(chop($line)===''){if(isset($CurrentBlock)){$CurrentBlock['interrupted']=true;}continue;}$indent=0;while(isset($line[$indent]) and $line[$indent]===' '){$indent++;}$text=$indent>0?substr($line,$indent):$line;$Line=array('body'=>$line,'indent'=>$indent,'text'=>$text);if(isset($CurrentBlock['incomplete'])){$Block=$this->{'addTo'.$CurrentBlock['type']}($Line,$CurrentBlock);if(isset($Block)){$CurrentBlock=$Block;continue;}else {if(method_exists($this,'complete'.$CurrentBlock['type'])){$CurrentBlock=$this->{'complete'.$CurrentBlock['type']}($CurrentBlock);}unset($CurrentBlock['incomplete']);}}$marker=$text[0];if(isset($this->DefinitionTypes[$marker])){foreach($this->DefinitionTypes[$marker] as $definitionType){$Definition=$this->{'identify'.$definitionType}($Line,$CurrentBlock);if(isset($Definition)){$this->Definitions[$definitionType][$Definition['id']]=$Definition['data'];continue 2;}}}$blockTypes=$this->unmarkedBlockTypes;if(isset($this->BlockTypes[$marker])){foreach($this->BlockTypes[$marker] as $blockType){$blockTypes[]=$blockType;}}foreach($blockTypes as $blockType){$Block=$this->{'identify'.$blockType}($Line,$CurrentBlock);if(isset($Block)){$Block['type']=$blockType;if(!isset($Block['identified'])){$Elements[]=$CurrentBlock['element'];$Block['identified']=true;}if(method_exists($this,'addTo'.$blockType)){$Block['incomplete']=true;}$CurrentBlock=$Block;continue 2;}}if(isset($CurrentBlock) and !isset($CurrentBlock['type']) and !isset($CurrentBlock['interrupted'])){$CurrentBlock['element']['text'].="\n".$text;}else {$Elements[]=$CurrentBlock['element'];$CurrentBlock=$this->buildParagraph($Line);$CurrentBlock['identified']=true;}}if(isset($CurrentBlock['incomplete']) and method_exists($this,'complete'.$CurrentBlock['type'])){$CurrentBlock=$this->{'complete'.$CurrentBlock['type']}($CurrentBlock);}$Elements[]=$CurrentBlock['element'];unset($Elements[0]);$markup=$this->elements($Elements);return $markup;} protected function identifyAtx($Line){if(isset($Line['text'][1])){$level=1;while(isset($Line['text'][$level]) and $Line['text'][$level]==='#'){$level++;}$text=trim($Line['text'],'# ');$Block=array('element'=>array('name'=>'h'.min(6,$level),'text'=>$text,'handler'=>'line',),);return $Block;}} protected function identifyCodeBlock($Line){if($Line['indent']>=4){$text=substr($Line['body'],4);$Block=array('element'=>array('name'=>'pre','handler'=>'element','text'=>array('name'=>'code','text'=>$text,),),);return $Block;}} protected function addToCodeBlock($Line,$Block){if($Line['indent']>=4){if(isset($Block['interrupted'])){$Block['element']['text']['text'].="\n";unset($Block['interrupted']);}$Block['element']['text']['text'].="\n";$text=substr($Line['body'],4);$Block['element']['text']['text'].=$text;return $Block;}} protected function completeCodeBlock($Block){$text=$Block['element']['text']['text'];$text=htmlspecialchars($text,ENT_NOQUOTES,'UTF-8');$Block['element']['text']['text']=$text;return $Block;} protected function identifyComment($Line){if(isset($Line['text'][3]) and $Line['text'][3]==='-' and $Line['text'][2]==='-' and $Line['text'][1]==='!'){$Block=array('element'=>$Line['body'],);if(preg_match('/-->$/',$Line['text'])){$Block['closed']=true;}return $Block;}} protected function addToComment($Line,array$Block){if(isset($Block['closed'])){return;}$Block['element'].="\n".$Line['body'];if(preg_match('/-->$/',$Line['text'])){$Block['closed']=true;}return $Block;} protected function identifyFencedCode($Line){if(preg_match('/^(['.$Line['text'][0].']{3,})[ ]*([\w-]+)?[ ]*$/',$Line['text'],$matches)){$Element=array('name'=>'code','text'=>'',);if(isset($matches[2])){$class='language-'.$matches[2];$Element['attributes']=array('class'=>$class,);}$Block=array('char'=>$Line['text'][0],'element'=>array('name'=>'pre','handler'=>'element','text'=>$Element,),);return $Block;}} protected function addToFencedCode($Line,$Block){if(isset($Block['complete'])){return;}if(isset($Block['interrupted'])){$Block['element']['text']['text'].="\n";unset($Block['interrupted']);}if(preg_match('/^'.$Block['char'].'{3,}[ ]*$/',$Line['text'])){$Block['element']['text']['text']=substr($Block['element']['text']['text'],1);$Block['complete']=true;return $Block;}$Block['element']['text']['text'].="\n".$Line['body'];;return $Block;} protected function completeFencedCode($Block){$text=$Block['element']['text']['text'];$text=htmlspecialchars($text,ENT_NOQUOTES,'UTF-8');$Block['element']['text']['text']=$text;return $Block;} protected function identifyList($Line){list($name,$pattern)=$Line['text'][0]<='-'?array('ul','[*+-]'):array('ol','[0-9]+[.]');if(preg_match('/^('.$pattern.'[ ]+)(.*)/',$Line['text'],$matches)){$Block=array('indent'=>$Line['indent'],'pattern'=>$pattern,'element'=>array('name'=>$name,'handler'=>'elements',),);$Block['li']=array('name'=>'li','handler'=>'li','text'=>array($matches[2],),);$Block['element']['text'][]=&$Block['li'];return $Block;}} protected function addToList($Line,array$Block){if($Block['indent']===$Line['indent'] and preg_match('/^'.$Block['pattern'].'[ ]+(.*)/',$Line['text'],$matches)){if(isset($Block['interrupted'])){$Block['li']['text'][]='';unset($Block['interrupted']);}unset($Block['li']);$Block['li']=array('name'=>'li','handler'=>'li','text'=>array($matches[1],),);$Block['element']['text'][]=&$Block['li'];return $Block;}if(!isset($Block['interrupted'])){$text=preg_replace('/^[ ]{0,4}/','',$Line['body']);$Block['li']['text'][]=$text;return $Block;}if($Line['indent']>0){$Block['li']['text'][]='';$text=preg_replace('/^[ ]{0,4}/','',$Line['body']);$Block['li']['text'][]=$text;unset($Block['interrupted']);return $Block;}} protected function identifyQuote($Line){if(preg_match('/^>[ ]?(.*)/',$Line['text'],$matches)){$Block=array('element'=>array('name'=>'blockquote','handler'=>'lines','text'=>(array)$matches[1],),);return $Block;}} protected function addToQuote($Line,array$Block){if($Line['text'][0]==='>' and preg_match('/^>[ ]?(.*)/',$Line['text'],$matches)){if(isset($Block['interrupted'])){$Block['element']['text'][]='';unset($Block['interrupted']);}$Block['element']['text'][]=$matches[1];return $Block;}if(!isset($Block['interrupted'])){$Block['element']['text'][]=$Line['text'];return $Block;}} protected function identifyRule($Line){if(preg_match('/^(['.$Line['text'][0].'])([ ]{0,2}\1){2,}[ ]*$/',$Line['text'])){$Block=array('element'=>array('name'=>'hr'),);return $Block;}} protected function identifySetext($Line,array$Block=null){if(!isset($Block) or isset($Block['type']) or isset($Block['interrupted'])){return;}if(chop($Line['text'],$Line['text'][0])===''){$Block['element']['name']=$Line['text'][0]==='='?'h1':'h2';return $Block;}} protected function identifyMarkup($Line){if(preg_match('/^<(\w[\w\d]*)(?:[ ][^>]*)?(\/?)[ ]*>/',$Line['text'],$matches)){if(in_array($matches[1],$this->textLevelElements)){return;}$Block=array('element'=>$Line['body'],);if($matches[2] or $matches[1]==='hr' or preg_match('/<\/'.$matches[1].'>[ ]*$/',$Line['text'])){$Block['closed']=true;}else {$Block['depth']=0;$Block['name']=$matches[1];}return $Block;}} protected function addToMarkup($Line,array$Block){if(isset($Block['closed'])){return;}if(preg_match('/<'.$Block['name'].'([ ][^\/]+)?>/',$Line['text'])){$Block['depth']++;}if(stripos($Line['text'],'</'.$Block['name'].'>')!==false){if($Block['depth']>0){$Block['depth']--;}else {$Block['closed']=true;}}$Block['element'].="\n".$Line['body'];return $Block;} protected function identifyTable($Line,array$Block=null){if(!isset($Block) or isset($Block['type']) or isset($Block['interrupted'])){return;}if(strpos($Block['element']['text'],'|')!==false and chop($Line['text'],' -:|')===''){$alignments=array();$divider=$Line['text'];$divider=trim($divider);$divider=trim($divider,'|');$dividerCells=explode('|',$divider);foreach($dividerCells as $dividerCell){$dividerCell=trim($dividerCell);if($dividerCell===''){continue;}$alignment=null;if($dividerCell[0]===':'){$alignment='left';}if(substr($dividerCell,-1)===':'){$alignment=$alignment==='left'?'center':'right';}$alignments[]=$alignment;}$HeaderElements=array();$header=$Block['element']['text'];$header=trim($header);$header=trim($header,'|');$headerCells=explode('|',$header);foreach($headerCells as $index=>$headerCell){$headerCell=trim($headerCell);$HeaderElement=array('name'=>'th','text'=>$headerCell,'handler'=>'line',);if(isset($alignments[$index])){$alignment=$alignments[$index];$HeaderElement['attributes']=array('align'=>$alignment,);}$HeaderElements[]=$HeaderElement;}$Block=array('alignments'=>$alignments,'identified'=>true,'element'=>array('name'=>'table','handler'=>'elements',),);$Block['element']['text'][]=array('name'=>'thead','handler'=>'elements',);$Block['element']['text'][]=array('name'=>'tbody','handler'=>'elements','text'=>array(),);$Block['element']['text'][0]['text'][]=array('name'=>'tr','handler'=>'elements','text'=>$HeaderElements,);return $Block;}} protected function addToTable($Line,array$Block){if($Line['text'][0]==='|' or strpos($Line['text'],'|')){$Elements=array();$row=$Line['text'];$row=trim($row);$row=trim($row,'|');$cells=explode('|',$row);foreach($cells as $index=>$cell){$cell=trim($cell);$Element=array('name'=>'td','handler'=>'line','text'=>$cell,);if(isset($Block['alignments'][$index])){$Element['attributes']=array('align'=>$Block['alignments'][$index],);}$Elements[]=$Element;}$Element=array('name'=>'tr','handler'=>'elements','text'=>$Elements,);$Block['element']['text'][1]['text'][]=$Element;return $Block;}} protected function identifyReference($Line){if(preg_match('/^\[(.+?)\]:[ ]*<?(\S+?)>?(?:[ ]+["\'(](.+)["\')])?[ ]*$/',$Line['text'],$matches)){$Definition=array('id'=>strtolower($matches[1]),'data'=>array('url'=>$matches[2],),);if(isset($matches[3])){$Definition['data']['title']=$matches[3];}return $Definition;}} protected function buildParagraph($Line){$Block=array('element'=>array('name'=>'p','text'=>$Line['text'],'handler'=>'line',),);return $Block;} protected function element(array$Element){$markup='<'.$Element['name'];if(isset($Element['attributes'])){foreach($Element['attributes'] as $name=>$value){$markup.=' '.$name.'="'.$value.'"';}}if(isset($Element['text'])){$markup.='>';if(isset($Element['handler'])){$markup.=$this->$Element['handler']($Element['text']);}else {$markup.=$Element['text'];}$markup.='</'.$Element['name'].'>';}else {$markup.=' />';}return $markup;} protected function elements(array$Elements){$markup='';foreach($Elements as $Element){if($Element===null){continue;}$markup.="\n";if(is_string($Element)){$markup.=$Element;continue;}$markup.=$this->element($Element);}$markup.="\n";return $markup;} protected $SpanTypes=array('!'=>array('Link'),'&'=>array('Ampersand'),'*'=>array('Emphasis'),'/'=>array('Url'),'<'=>array('UrlTag','EmailTag','Tag','LessThan'),'['=>array('Link'),'_'=>array('Emphasis'),'`'=>array('InlineCode'),'~'=>array('Strikethrough'),'\\'=>array('EscapeSequence'),); protected $spanMarkerList='*_!&[</`~\\'; public function line($text){$markup='';$remainder=$text;$markerPosition=0;while($excerpt=strpbrk($remainder,$this->spanMarkerList)){$marker=$excerpt[0];$markerPosition+=strpos($remainder,$marker);$Excerpt=array('text'=>$excerpt,'context'=>$text);foreach($this->SpanTypes[$marker] as $spanType){$handler='identify'.$spanType;$Span=$this->$handler($Excerpt);if(!isset($Span)){continue;}if(isset($Span['position']) and $Span['position']>$markerPosition){continue;}if(!isset($Span['position'])){$Span['position']=$markerPosition;}$plainText=substr($text,0,$Span['position']);$markup.=$this->readPlainText($plainText);$markup.=isset($Span['markup'])?$Span['markup']:$this->element($Span['element']);$text=substr($text,$Span['position']+$Span['extent']);$remainder=$text;$markerPosition=0;continue 2;}$remainder=substr($excerpt,1);$markerPosition++;}$markup.=$this->readPlainText($text);return $markup;} protected function identifyUrl($Excerpt){if(!isset($Excerpt['text'][1]) or $Excerpt['text'][1]!=='/'){return;}if(preg_match('/\bhttps?:[\/]{2}[^\s<]+\b\/*/ui',$Excerpt['context'],$matches,PREG_OFFSET_CAPTURE)){$url=str_replace(array('&','<'),array('&amp;','&lt;'),$matches[0][0]);return array('extent'=>strlen($matches[0][0]),'position'=>$matches[0][1],'element'=>array('name'=>'a','text'=>$url,'attributes'=>array('href'=>$url,),),);}} protected function identifyAmpersand($Excerpt){if(!preg_match('/^&#?\w+;/',$Excerpt['text'])){return array('markup'=>'&amp;','extent'=>1,);}} protected function identifyStrikethrough($Excerpt){if(!isset($Excerpt['text'][1])){return;}if($Excerpt['text'][1]==='~' and preg_match('/^~~(?=\S)(.+?)(?<=\S)~~/',$Excerpt['text'],$matches)){return array('extent'=>strlen($matches[0]),'element'=>array('name'=>'del','text'=>$matches[1],'handler'=>'line',),);}} protected function identifyEscapeSequence($Excerpt){if(isset($Excerpt['text'][1]) and in_array($Excerpt['text'][1],$this->specialCharacters)){return array('markup'=>$Excerpt['text'][1],'extent'=>2,);}} protected function identifyLessThan(){return array('markup'=>'&lt;','extent'=>1,);} protected function identifyUrlTag($Excerpt){if(strpos($Excerpt['text'],'>')!==false and preg_match('/^<(https?:[\/]{2}[^\s]+?)>/i',$Excerpt['text'],$matches)){$url=str_replace(array('&','<'),array('&amp;','&lt;'),$matches[1]);return array('extent'=>strlen($matches[0]),'element'=>array('name'=>'a','text'=>$url,'attributes'=>array('href'=>$url,),),);}} protected function identifyEmailTag($Excerpt){if(strpos($Excerpt['text'],'>')!==false and preg_match('/^<(\S+?@\S+?)>/',$Excerpt['text'],$matches)){return array('extent'=>strlen($matches[0]),'element'=>array('name'=>'a','text'=>$matches[1],'attributes'=>array('href'=>'mailto:'.$matches[1],),),);}} protected function identifyTag($Excerpt){if(strpos($Excerpt['text'],'>')!==false and preg_match('/^<\/?\w.*?>/',$Excerpt['text'],$matches)){return array('markup'=>$matches[0],'extent'=>strlen($matches[0]),);}} protected function identifyInlineCode($Excerpt){$marker=$Excerpt['text'][0];if(preg_match('/^('.$marker.'+)[ ]*(.+?)[ ]*(?<!'.$marker.')\1(?!'.$marker.')/',$Excerpt['text'],$matches)){$text=$matches[2];$text=htmlspecialchars($text,ENT_NOQUOTES,'UTF-8');return array('extent'=>strlen($matches[0]),'element'=>array('name'=>'code','text'=>$text,),);}} protected function identifyLink($Excerpt){$extent=$Excerpt['text'][0]==='!'?1:0;if(strpos($Excerpt['text'],']') and preg_match('/\[((?:[^][]|(?R))*)\]/',$Excerpt['text'],$matches)){$Link=array('text'=>$matches[1],'label'=>strtolower($matches[1]));$extent+=strlen($matches[0]);$substring=substr($Excerpt['text'],$extent);if(preg_match('/^\s*\[([^][]+)\]/',$substring,$matches)){$Link['label']=strtolower($matches[1]);if(isset($this->Definitions['Reference'][$Link['label']])){$Link+=$this->Definitions['Reference'][$Link['label']];$extent+=strlen($matches[0]);}else {return;}}elseif(isset($this->Definitions['Reference'][$Link['label']])){$Link+=$this->Definitions['Reference'][$Link['label']];if(preg_match('/^[ ]*\[\]/',$substring,$matches)){$extent+=strlen($matches[0]);}}elseif(preg_match('/^\([ ]*(.*?)(?:[ ]+[\'"](.+?)[\'"])?[ ]*\)/',$substring,$matches)){$Link['url']=$matches[1];if(isset($matches[2])){$Link['title']=$matches[2];}$extent+=strlen($matches[0]);}else {return;}}else {return;}$url=str_replace(array('&','<'),array('&amp;','&lt;'),$Link['url']);if($Excerpt['text'][0]==='!'){$Element=array('name'=>'img','attributes'=>array('alt'=>$Link['text'],'src'=>$url,),);}else {$Element=array('name'=>'a','handler'=>'line','text'=>$Link['text'],'attributes'=>array('href'=>$url,),);}if(isset($Link['title'])){$Element['attributes']['title']=$Link['title'];}return array('extent'=>$extent,'element'=>$Element,);} protected function identifyEmphasis($Excerpt){if(!isset($Excerpt['text'][1])){return;}$marker=$Excerpt['text'][0];if($Excerpt['text'][1]===$marker and preg_match($this->StrongRegex[$marker],$Excerpt['text'],$matches)){$emphasis='strong';}elseif(preg_match($this->EmRegex[$marker],$Excerpt['text'],$matches)){$emphasis='em';}else {return;}return array('extent'=>strlen($matches[0]),'element'=>array('name'=>$emphasis,'handler'=>'line','text'=>$matches[1],),);} protected function readPlainText($text){$breakMarker=$this->breaksEnabled?"\n":"  \n";$text=str_replace($breakMarker,"<br />\n",$text);return $text;} protected function li($lines){$markup=$this->lines($lines);$trimmedMarkup=trim($markup);if(!in_array('',$lines) and substr($trimmedMarkup,0,3)==='<p>'){$markup=$trimmedMarkup;$markup=substr($markup,3);$position=strpos($markup,"</p>");$markup=substr_replace($markup,'',$position,4);}return $markup;}static function instance($name='default'){if(isset(self::$instances[$name])){return self::$instances[$name];}$instance=new self();self::$instances[$name]=$instance;return $instance;} private static $instances=array();function parse($text){$markup=$this->text($text);return $markup;} protected $Definitions; protected $specialCharacters=array('\\','`','*','_','{','}','[',']','(',')','>','#','+','-','.','!',); protected $StrongRegex=array('*'=>'/^[*]{2}((?:[^*]|[*][^*]*[*])+?)[*]{2}(?![*])/s','_'=>'/^__((?:[^_]|_[^_]*_)+?)__(?!_)/us',); protected $EmRegex=array('*'=>'/^[*]((?:[^*]|[*][*][^*]+?[*][*])+?)[*](?![*])/s','_'=>'/^_((?:[^_]|__[^_]*__)+?)_(?!_)\b/us',); protected $textLevelElements=array('a','br','bdo','abbr','blink','nextid','acronym','basefont','b','em','big','cite','small','spacer','listing','i','rp','del','code','strike','marquee','q','rt','ins','font','strong','s','tt','sub','mark','u','xm','sup','nobr','var','ruby','wbr','span','time',);}
class ParsedownExtra extends Parsedown{function __construct(){$this->BlockTypes[':'][]='DefinitionList';$this->DefinitionTypes['*'][]='Abbreviation';array_unshift($this->DefinitionTypes['['],'Footnote');array_unshift($this->SpanTypes['['],'FootnoteMarker');}function text($text){$markup=parent::text($text);$markup=preg_replace('/<\/dl>\s+<dl>\s+/','',$markup);if(isset($this->Definitions['Footnote'])){$Element=$this->buildFootnoteElement();$markup.="\n".$this->element($Element);}return $markup;} protected function identifyAtx($Line){$Block=parent::identifyAtx($Line);if(preg_match('/[ ]*'.$this->attributesPattern.'[ ]*$/',$Block['element']['text'],$matches,PREG_OFFSET_CAPTURE)){$attributeString=$matches[1][0];$Block['element']['attributes']=$this->parseAttributes($attributeString);$Block['element']['text']=substr($Block['element']['text'],0,$matches[0][1]);}return $Block;} protected function identifyDefinitionList($Line,$Block){if(isset($Block['type'])){return;}$Element=array('name'=>'dl','handler'=>'elements','text'=>array(),);$terms=explode("\n",$Block['element']['text']);foreach($terms as $term){$Element['text'][]=array('name'=>'dt','handler'=>'line','text'=>$term,);}$Element['text'][]=array('name'=>'dd','handler'=>'line','text'=>ltrim($Line['text'],' :'),);$Block['element']=$Element;return $Block;} protected function addToDefinitionList($Line,array$Block){if($Line['text'][0]===':'){$Block['element']['text'][]=array('name'=>'dd','handler'=>'line','text'=>ltrim($Line['text'],' :'),);return $Block;}if(!isset($Block['interrupted'])){$Element=array_pop($Block['element']['text']);$Element['text'].="\n".chop($Line['text']);$Block['element']['text'][]=$Element;return $Block;}} protected function identifySetext($Line,array$Block=null){$Block=parent::identifySetext($Line,$Block);if(preg_match('/[ ]*'.$this->attributesPattern.'[ ]*$/',$Block['element']['text'],$matches,PREG_OFFSET_CAPTURE)){$attributeString=$matches[1][0];$Block['element']['attributes']=$this->parseAttributes($attributeString);$Block['element']['text']=substr($Block['element']['text'],0,$matches[0][1]);}return $Block;} protected function completeMarkup($Block){$DOMDocument=new DOMDocument;$DOMDocument->loadXML($Block['element'],LIBXML_NOERROR|LIBXML_NOWARNING);if($DOMDocument->documentElement===null){return $Block;}$result=$DOMDocument->documentElement->getAttribute('markdown');if($result!=='1'){return $Block;}$DOMDocument->documentElement->removeAttribute('markdown');$index=0;$texts=array();foreach($DOMDocument->documentElement->childNodes as $Node){if($Node instanceof DOMText){$texts[]=$this->text($Node->nodeValue);$Node->nodeValue='\x1A'.$index++;}}$markup=$DOMDocument->saveXML($DOMDocument->documentElement);foreach($texts as $index=>$text){$markup=str_replace('\x1A'.$index,$text,$markup);}$Block['element']=$markup;return $Block;} protected function identifyAbbreviation($Line){if(preg_match('/^\*\[(.+?)\]:[ ]*(.+?)[ ]*$/',$Line['text'],$matches)){$Abbreviation=array('id'=>$matches[1],'data'=>$matches[2],);return $Abbreviation;}} protected function identifyFootnote($Line){if(preg_match('/^\[\^(.+?)\]:[ ]?(.+)$/',$Line['text'],$matches)){$Footnote=array('id'=>$matches[1],'data'=>array('text'=>$matches[2],'count'=>null,'number'=>null,),);return $Footnote;}} protected function identifyFootnoteMarker($Excerpt){if(preg_match('/^\[\^(.+?)\]/',$Excerpt['text'],$matches)){$name=$matches[1];if(!isset($this->Definitions['Footnote'][$name])){return;}$this->Definitions['Footnote'][$name]['count']++;if(!isset($this->Definitions['Footnote'][$name]['number'])){$this->Definitions['Footnote'][$name]['number']=++$this->footnoteCount;}$Element=array('name'=>'sup','attributes'=>array('id'=>'fnref'.$this->Definitions['Footnote'][$name]['count'].':'.$name),'handler'=>'element','text'=>array('name'=>'a','attributes'=>array('href'=>'#fn:'.$name,'class'=>'footnote-ref'),'text'=>$this->Definitions['Footnote'][$name]['number'],),);return array('extent'=>strlen($matches[0]),'element'=>$Element,);}} private $footnoteCount=0; protected function identifyLink($Excerpt){$Span=parent::identifyLink($Excerpt);$remainder=substr($Excerpt['text'],$Span['extent']);if(preg_match('/^[ ]*'.$this->attributesPattern.'/',$remainder,$matches)){$Span['element']['attributes']+=$this->parseAttributes($matches[1]);$Span['extent']+=strlen($matches[0]);}return $Span;} protected function readPlainText($text){$text=parent::readPlainText($text);if(isset($this->Definitions['Abbreviation'])){foreach($this->Definitions['Abbreviation'] as $abbreviation=>$phrase){$text=str_replace($abbreviation,'<abbr title="'.$phrase.'">'.$abbreviation.'</abbr>',$text);}}return $text;} protected function buildFootnoteElement(){$Element=array('name'=>'div','attributes'=>array('class'=>'footnotes'),'handler'=>'elements','text'=>array(array('name'=>'hr',),array('name'=>'ol','handler'=>'elements','text'=>array(),),),);usort($this->Definitions['Footnote'],function($A,$B){return $A['number']-$B['number'];});foreach($this->Definitions['Footnote'] as $name=>$Data){if(!isset($Data['number'])){continue;}$text=$Data['text'];foreach(range(1,$Data['count']) as $number){$text.='&#160;<a href="#fnref'.$number.':'.$name.'" rev="footnote" class="footnote-backref">&#8617;</a>';}$Element['text'][1]['text'][]=array('name'=>'li','attributes'=>array('id'=>'fn:'.$name),'handler'=>'elements','text'=>array(array('name'=>'p','text'=>$text,),),);}return $Element;} private function parseAttributes($attributeString){$Data=array();$attributes=preg_split('/[ ]+/',$attributeString,-1,PREG_SPLIT_NO_EMPTY);foreach($attributes as $attribute){if($attribute[0]==='#'){$Data['id']=substr($attribute,1);}else {$classes[]=substr($attribute,1);}}if(isset($classes)){$Data['class']=implode(' ',$classes);}return $Data;} private $attributesPattern='{((?:[#.][-\w]+[ ]*)+)}';}

//Define index reader
function readIndex($baseDir, $prefix = ""){

	$excludePattern = "[_\.]";

	$dirList = array();
	$pageList = array();
	$resultList = array();

	$files = scandir($baseDir);

	foreach($files as $filename){

		if(preg_match("/^(\.\.|" . $excludePattern .")/", $filename)) continue;

		if(is_dir("{$baseDir}/{$filename}")){

			$dirList[$filename] = readIndex("{$baseDir}/{$filename}", $filename . "/");

		} elseif(substr($filename, -3, 3) == ".md") {

			$pageList[$prefix . basename($filename, ".md")] = basename($filename, ".md");

		}

	}

	ksort($dirList);
	ksort($pageList);

	foreach($dirList as $k => $v)  $resultList[$k] = $v;
	foreach($pageList as $k => $v) $resultList[$k] = $v;

	return $resultList;

}

//Define menu renderer
function renderIndex($pages = array(), $current = null){
?>
<ul>
<?php foreach($pages as $name => $item): ?>
	<?php if(is_array($item)): ?> 
	<li class="dir">
		<span class="title"><?php echo preg_replace("/([0-9]+__|[-_])/", " ", $name); ?></span>
<?php renderIndex($item, $current); ?>
	</li>
	<?php else: ?> 
	<li class="page"><a href="<?php echo urlencode($name); ?>.html" class="<?php if($name == $current): ?>current<?php endif; ?>"><?php echo preg_replace("/([0-9]+__|[-_])/", " ", $item); ?></a></li>
	<?php endif; ?>
<?php endforeach; ?>
</ul>
<?php
}

//Define renderer
function renderPage($mdIndex, $pageFilename){
	global $title, $description, $index;

	ob_start();
?>
<!doctype html>
	<head>
		<title><?php echo $title; ?></title>
		<style>@import url(http://fonts.googleapis.com/css?family=Roboto:400,300,500&subset=latin,latin-ext);*{margin:0;padding:0}body{background:#fff;font-family:Roboto,sans-serif;color:#222;font-size:15px;line-height:1}#sidebar{position:fixed;left:0;top:0;bottom:0;width:260px;background:#f3f3f3;box-shadow:0 0 8px rgba(0,0,0,.3)}#sidebar #doc-title{font-weight:300;font-size:22px;padding:24px 12px 10px;background:#f6f6f6}#sidebar #doc-title a{color:#0096ff;text-decoration:none}#sidebar #doc-title a:hover{text-decoration:underline}#sidebar #doc-description{font-weight:300;font-size:15px;padding:0 12px 16px;border-bottom:1px solid #ccc;background:#f6f6f6}#sidebar nav{position:absolute;left:0;right:0;top:100px;bottom:41px;overflow-y:auto;font-size:14px}#sidebar nav ul{list-style:none}#sidebar nav ul li{margin-bottom:6px}#sidebar nav ul li a{display:block;color:#151515;text-decoration:none;padding:10px}#sidebar nav ul li a:hover{background:#e3e3e3}#sidebar nav ul li a.current{background:#0096ff;color:#fff}#sidebar nav ul li .title{display:block;font-size:21px;font-weight:300;margin-bottom:8px}#sidebar nav ul li.dir{border-left:6px solid #999;margin-bottom:14px;padding:6px 0 0 8px}#sidebar #nav-down{position:absolute;display:none;left:0;top:88px;bottom:41px;width:240px;padding:10px;font-size:14px;border:0;background:#fff}#sidebar #nav-down.opened{display:block}#sidebar #toolbar{position:absolute;left:0;right:0;bottom:0;height:26px;line-height:26px;padding:7px;border-top:1px solid #ccc}#sidebar #toolbar .icon{display:block;padding-left:26px;width:0;height:26px;line-height:26px;overflow:hidden;background-repeat:no-repeat;background-position:top left;opacity:.5;transition:opacity .3s}#sidebar #toolbar .icon:hover{opacity:1}#sidebar #toolbar .icon-nav{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABoAAAAaCAYAAACpSkzOAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNSBNYWNpbnRvc2giIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6ODA5N0QxMjQyM0MwMTFFMUE2Q0FEQ0Y1QzQ2NkVERTciIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6ODA5N0QxMjUyM0MwMTFFMUE2Q0FEQ0Y1QzQ2NkVERTciPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo4MDk3RDEyMjIzQzAxMUUxQTZDQURDRjVDNDY2RURFNyIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo4MDk3RDEyMzIzQzAxMUUxQTZDQURDRjVDNDY2RURFNyIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PvhhcLgAAAC7SURBVHjaYvz//z8DPQCjsbGxAJBeD8QONLLjABAHMktJSW2noSUgoADEFkw0tgQGHJgY6AToZhELjHH27FlGWlgATGz/B8ZHSC54D6QEcKj/AMSKQN9/GPxxhAQUgdgAh/oL5PgGq0VQgw7Qw0c0ibMBjSOaxBlBi6gVZywk5nKy42tQxRFV4oskiyiJr9GyjuyyjhFWMQFBI9CQBipWeKDgLwDiephF++nQQDkAiqNAWpTW6O06gAADAPBDTUQmiw9zAAAAAElFTkSuQmCC)}#content{padding:33px 40px 40px 300px}.markdown-body{-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%;color:#333;overflow:hidden;font-size:16px;line-height:1.6;word-wrap:break-word}.markdown-body a{background:0 0}.markdown-body a:active,.markdown-body a:hover{outline:0}.markdown-body strong{font-weight:500}.markdown-body h1{margin:.67em 0}.markdown-body img{border:0}.markdown-body hr{-moz-box-sizing:content-box;box-sizing:content-box}.markdown-body input{color:inherit;font:inherit;margin:0}.markdown-body html input[disabled]{cursor:default}.markdown-body input[type=checkbox]{box-sizing:border-box;padding:0}.markdown-body table{border-collapse:collapse;border-spacing:0}.markdown-body td,.markdown-body th{padding:0}.markdown-body *{-moz-box-sizing:border-box;box-sizing:border-box}.markdown-body input{line-height:1.4}.markdown-body a{color:#4183c4;text-decoration:none}.markdown-body a:active,.markdown-body a:focus,.markdown-body a:hover{text-decoration:underline}.markdown-body a[name],.markdown-body a[name]:active,.markdown-body a[name]:focus,.markdown-body a[name]:hover{text-decoration:none;color:#000}.markdown-body hr{overflow:hidden;background:0 0}.markdown-body hr:after,.markdown-body hr:before{display:table;content:" "}.markdown-body hr:after{clear:both}.markdown-body blockquote{margin:0}.markdown-body ol,.markdown-body ul{padding:0}.markdown-body ol ol,.markdown-body ul ol{list-style-type:lower-roman}.markdown-body ol ol ol,.markdown-body ol ul ol,.markdown-body ul ol ol,.markdown-body ul ul ol{list-style-type:lower-alpha}.markdown-body dd{margin-left:0}.markdown-body code,.markdown-body pre{font-family:Consolas,"Liberation Mono",Menlo,Courier,monospace}.markdown-body kbd{background-color:#e7e7e7;background-image:-moz-linear-gradient(#fefefe,#e7e7e7);background-image:-webkit-linear-gradient(#fefefe,#e7e7e7);background-image:linear-gradient(#fefefe,#e7e7e7);background-repeat:repeat-x;border-radius:2px;border:1px solid #cfcfcf;color:#000;padding:3px 5px;line-height:10px;font:11px Consolas,"Liberation Mono",Menlo,Courier,monospace;display:inline-block}.markdown-body>:first-child{margin-top:0!important}.markdown-body>:last-child{margin-bottom:0!important}.markdown-body .anchor{position:absolute;top:0;bottom:0;left:0;display:block;padding-right:6px;padding-left:30px;margin-left:-30px}.markdown-body .anchor:focus{outline:0}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{position:relative;margin-top:1em;margin-bottom:16px;font-weight:300;line-height:1.4}.markdown-body h1 .octicon-link,.markdown-body h2 .octicon-link,.markdown-body h3 .octicon-link,.markdown-body h4 .octicon-link,.markdown-body h5 .octicon-link,.markdown-body h6 .octicon-link{display:none;color:#000;vertical-align:middle}.markdown-body h1:hover .anchor,.markdown-body h2:hover .anchor,.markdown-body h3:hover .anchor,.markdown-body h4:hover .anchor,.markdown-body h5:hover .anchor,.markdown-body h6:hover .anchor{height:1em;padding-left:8px;margin-left:-30px;line-height:1;text-decoration:none}.markdown-body h1:hover .anchor .octicon-link,.markdown-body h2:hover .anchor .octicon-link,.markdown-body h3:hover .anchor .octicon-link,.markdown-body h4:hover .anchor .octicon-link,.markdown-body h5:hover .anchor .octicon-link,.markdown-body h6:hover .anchor .octicon-link{display:inline-block}.markdown-body h1{padding-bottom:.3em;font-size:2.25em;line-height:1.2;border-bottom:1px solid #ccc}.markdown-body h2{padding-bottom:.3em;font-size:1.75em;line-height:1.225;border-bottom:1px solid #ccc}.markdown-body h3{font-size:1.5em;line-height:1.43}.markdown-body h4{font-size:1.25em}.markdown-body h5{font-size:1em}.markdown-body h6{font-size:1em;color:#777}.markdown-body blockquote,.markdown-body dl,.markdown-body ol,.markdown-body p,.markdown-body pre,.markdown-body table,.markdown-body ul{margin-top:0;margin-bottom:16px}.markdown-body hr{height:4px;padding:0;margin:16px 0;background-color:#e7e7e7;border:0}.markdown-body ol,.markdown-body ul{padding-left:2em}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:0;margin-bottom:0}.markdown-body li>p{margin-top:16px}.markdown-body dl{padding:0}.markdown-body dl dt{padding:0;margin-top:16px;font-size:1em;font-style:italic;font-weight:500}.markdown-body dl dd{padding:0 16px;margin-bottom:16px}.markdown-body blockquote{padding:0 15px;color:#777;border-left:4px solid #ddd}.markdown-body blockquote>:first-child{margin-top:0}.markdown-body blockquote>:last-child{margin-bottom:0}.markdown-body table{display:block;width:100%;overflow:auto;word-break:normal;word-break:keep-all}.markdown-body table th{font-weight:500}.markdown-body table td,.markdown-body table th{padding:6px 13px;border:1px solid #ddd}.markdown-body table tr{background-color:#fff;border-top:1px solid #ccc}.markdown-body table tr:nth-child(2n){background-color:#f8f8f8}.markdown-body img{max-width:100%;-moz-box-sizing:border-box;box-sizing:border-box}.markdown-body code{padding:.2em 0;margin:0;font-size:85%;background-color:rgba(0,0,0,.04);border-radius:3px}.markdown-body code:after,.markdown-body code:before{letter-spacing:-.2em;content:"\00a0"}.markdown-body pre>code{padding:0;margin:0;font-size:100%;word-break:normal;white-space:pre;background:0 0;border:0}.markdown-body .highlight{margin-bottom:16px}.markdown-body .highlight pre,.markdown-body pre{padding:16px;overflow:auto;font-size:85%;line-height:1.45;background-color:#f6f6f6;border-radius:3px;border:1px dashed #ccc}.markdown-body .highlight pre{margin-bottom:0;word-break:normal}.markdown-body pre{word-wrap:normal}.markdown-body pre code{display:inline;max-width:initial;padding:0;margin:0;overflow:initial;line-height:inherit;word-wrap:normal;background-color:transparent;border:0}.markdown-body pre code:after,.markdown-body pre code:before{content:normal}.markdown-body .highlight{background:#fff}.markdown-body .highlight .c{color:#998;font-style:italic}.markdown-body .highlight .err{color:#a61717;background-color:#e3d2d2}.markdown-body .highlight .k,.markdown-body .highlight .o{font-weight:500}.markdown-body .highlight .cm{color:#998;font-style:italic}.markdown-body .highlight .cp{color:#999;font-weight:500}.markdown-body .highlight .c1{color:#998;font-style:italic}.markdown-body .highlight .cs{color:#999;font-weight:500;font-style:italic}.markdown-body .highlight .gd{color:#000;background-color:#fdd}.markdown-body .highlight .gd .x{color:#000;background-color:#faa}.markdown-body .highlight .ge{font-style:italic}.markdown-body .highlight .gr{color:#a00}.markdown-body .highlight .gh{color:#999}.markdown-body .highlight .gi{color:#000;background-color:#dfd}.markdown-body .highlight .gi .x{color:#000;background-color:#afa}.markdown-body .highlight .go{color:#888}.markdown-body .highlight .gp{color:#555}.markdown-body .highlight .gs{font-weight:500}.markdown-body .highlight .gu{color:purple;font-weight:500}.markdown-body .highlight .gt{color:#a00}.markdown-body .highlight .kc,.markdown-body .highlight .kd,.markdown-body .highlight .kn,.markdown-body .highlight .kp,.markdown-body .highlight .kr{font-weight:500}.markdown-body .highlight .kt{color:#458;font-weight:500}.markdown-body .highlight .m{color:#099}.markdown-body .highlight .s{color:#d14}.markdown-body .highlight .n{color:#333}.markdown-body .highlight .na{color:teal}.markdown-body .highlight .nb{color:#0086b3}.markdown-body .highlight .nc{color:#458;font-weight:500}.markdown-body .highlight .no{color:teal}.markdown-body .highlight .ni{color:purple}.markdown-body .highlight .ne,.markdown-body .highlight .nf{color:#900;font-weight:500}.markdown-body .highlight .nn{color:#555}.markdown-body .highlight .nt{color:navy}.markdown-body .highlight .nv{color:teal}.markdown-body .highlight .ow{font-weight:500}.markdown-body .highlight .w{color:#bbb}.markdown-body .highlight .mf,.markdown-body .highlight .mh,.markdown-body .highlight .mi,.markdown-body .highlight .mo{color:#099}.markdown-body .highlight .s2,.markdown-body .highlight .sb,.markdown-body .highlight .sc,.markdown-body .highlight .sd,.markdown-body .highlight .se,.markdown-body .highlight .sh,.markdown-body .highlight .si,.markdown-body .highlight .sx{color:#d14}.markdown-body .highlight .sr{color:#009926}.markdown-body .highlight .s1{color:#d14}.markdown-body .highlight .ss{color:#990073}.markdown-body .highlight .bp{color:#999}.markdown-body .highlight .vc,.markdown-body .highlight .vg,.markdown-body .highlight .vi{color:teal}.markdown-body .highlight .il{color:#099}.markdown-body .highlight .gc{color:#999;background-color:#EAF2F5}.markdown-body .octicon{line-height:1;display:inline-block;text-decoration:none;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.markdown-body .octicon-link:before{content:'\f05c'}.markdown-body .task-list-item{list-style-type:none}.markdown-body .task-list-item+.task-list-item{margin-top:3px}.markdown-body .task-list-item-checkbox{margin:0 4px .25em -20px;vertical-align:middle}</style>
	</head>
	<body>

		<div id="sidebar">
			<p id="doc-title"><a href="<?php echo $index; ?>.html" title="Go to index page"><?php echo $title; ?></a></p>
			<p id="doc-description"><?php echo $description; ?></p>
			<nav>
<?php renderIndex($mdIndex, basename($pageFilename, ".md")); ?>
			</nav>
		</div>

		<div id="content" class="markdown-body">
<?php
		$pageContents = file_get_contents($pageFilename);
		$pageContents = preg_replace("/\[(.*)\]\(\.\/(.*)\.(md|MD)\)/", '[${1}](${2}.html)' , $pageContents);

		$parser = new ParsedownExtra();
		echo $parser->text($pageContents);
?>
		</div>

	</body>
</html>
<?php
	return ob_get_clean();
}

//Define directory processing function
function processDirectory($srcIndex) {
	if(!$srcIndex) return;

	global $srcDir, $dstDir, $mdIndex;

	foreach($srcIndex as $name => $items){

		echo "Rendering $name\n";

		$pageFilename = "{$srcDir}/{$name}.md";
		$htmlFilename = "{$dstDir}/{$name}.html";

		if(is_dir("{$srcDir}/{$name}")){

			if(!file_exists("{$dstDir}/{$name}"))
				mkdir("{$dstDir}/{$name}");

			processDirectory($items);

		} else {

			$output = renderPage($mdIndex, $pageFilename);
			file_put_contents($htmlFilename, $output);

		}

	}

}

//Start
$mdIndex = readIndex($srcDir);

processDirectory($mdIndex);

echo "Done.";